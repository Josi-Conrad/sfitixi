{# src\Tixi\HomeBundle\Resources\views\Default\index.html.twig #}
{# 17.08.2013 martin jonasse initial file #}
{# 26.08.2013 martin jonasse added errormsg code #}
{# 02.09.2013 martin jonasse modified all variables to be read from session #}
{# 21.09.2013 martin jonasse changed error line to alert message #}
{# 25.10.2013 martin jonasse added modal dialog (overlay) #}
{# 26.11.2013 martin jonasse fixed ticket#3 added breadcrumb ID #}

{% extends '::base.html.twig' %}

{% block title %}{{ app.session.get('title') }}{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('css/sfitixi.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('css/table_style.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('css/login_style.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block body %}

    <!--APPLICATION BAR: with function points and anchors -->
    {% block frame %}
        <div class="frame">
            <div class="frame-table">
                <div class="frame-row">
                    <div class="frame-logo">
                        <a href="{{ app.session.get('baseurl') }}/home" id="fpm_home">
                            <img src="{{ asset('images/logo44px.png') }}" alt="Logo iTIXI" />
                        </a>
                    </div>
                    <div class="frame-left">
                        <div>
                            <a href="{{ app.session.get('baseurl') }}/public/about" id="fpm_public_about">
                                {{ tixi.application }}&nbsp;{{ tixi.version }}
                            </a>
                        </div>
                        <div>
                            <a href="{{ app.session.get('baseurl') }}/public/customer" id="fpm_public_customer">
                                Mandant:&nbsp;{{ app.session.get('customer') }}
                            </a>
                        </div>
                    </div>
                    <div class="frame-left">
                        <div id="fpr_breadcrumb">{{ app.session.get('breadcrumb') }}</div>
                    </div>
                    <div class="frame-right">
                        {%  if app.session.get('username') == tixi.undefined %}
                            <a href="{{ app.session.get('baseurl') }}/login" id="fpm_public_login">
                                <div>{{ app.session.get('username') }}:login</div>
                            </a>
                        {%  else %}
                            <a href="{{ app.session.get('baseurl') }}/public/logout" id="fpm_public_logout">
                                <div>{{ app.session.get('username') }}:logout</div>
                            </a>
                        {% endif %}
                        <div>
                            <a href="{{ app.session.get('baseurl') }}/app/preferences" id="fpm_home_preferences">Einstellungen</a>
                            |
                            <a href="{{ app.session.get('baseurl') }}/public/support" id="fpm_home_support">Support</a>
                            |
                            <a href="{{ app.session.get('baseurl') }}/public/help" id="fpm_home_help">Hilfe</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endblock %}

    <!-- MENU-BAR: with function points and anchors -->
    {% block menubar %}
        {{ include( 'TixiHomeBundle:Default:menu.html.twig' ) }}
    {% endblock %}

    <!--SUBJECT & TASK BAR: with function points and anchors -->
    <div class="subject-taskbars">
    {% block subject %}
        <div class="subject">
            <div class="subject-row">
                <div class="subject-left">
                    <div id="fpr_subject">{{ app.session.get('subject') }}</div>
                </div>
                <div class="subject-right">
                    <a href="{{ path( app.request.attributes.get('_route'), {'action':'print'} ) }}" id="fpm_print">
                        <img src="{{ asset('images/printer-blue.png') }}" alt="printer" />
                    </a>
                </div>
            </div>
        </div>
    {% endblock %}

    {% block taskbar %}
        <div class="taskbar">
            <div class="taskbar-row">
                <div class="taskbar-left">
                    {% if app.session.get('mode') == tixi.mode_select_list %}
                        <form class="taskbar-filter" name="tixi_filter">
                            <input id="fpw_filter" class="taskbar-left-filter-text" type="text"
                                   value="{{ app.session.get('filter') }}"
                                   placeholder="{{ tixi.filter }}"
                                   onblur="location.href='{{ path( app.request.attributes.get('_route'), {'action':'filter', 'filter': '' } ) }}'
                                           +document.getElementById('fpw_filter').value; overlay();" />
                            <input id="fpm_filter" class="taskbar-left-filter-button" type="button" value="Filtern"
                                   onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'filter', 'filter': '' } ) }}'
                                           +document.getElementById('fpw_filter').value; overlay();"/>
                        </form>
                    {% endif %}
                </div>
                <div class="taskbar-right">
                    {% if app.session.get('mode') == tixi.mode_select_list %}
                        <input id="fpm_add" type="button" value="Hinzuf&uuml;gen"
                           onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'add'} ) }}'"/>
                        <input id="fpm_modify" type="button" value="Bearbeiten"
                           onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'modify'} ) }}'"/>
                        <input id="fpm_delete" type="button" value="LÃ¶schen"
                           onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'delete'} ) }}'"/>
                    {% elseif app.session.get('mode') == tixi.mode_edit_in_list %}
                        <input id="fpm_save" type="button" value="Speichern"
                           onclick="document.forms['tixi_form'].submit()"/>
                        <input id="fpm_cancel" type="button" value="Abbrechen"
                           onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'cancel'} ) }}'"/>
                    {% elseif app.session.get('mode') == tixi.mode_read_record %}
                        <input id="fpm_modify" type="button" value="Bearbeiten"
                               onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'modify'} ) }}'"/>
                    {% elseif app.session.get('mode') == tixi.mode_edit_record %}
                        <input id="fpm_save" type="submit" value="Speichern"
                               onclick="document.forms['tixi_form'].submit()"/>
                        <input id="fpm_cancel" type="button" value="Abbrechen"
                               onclick="location.href='{{ path( app.request.attributes.get('_route'), {'action':'cancel'} ) }}'"/>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endblock %}

    <!--Content: with lists and forms -->
    {% block content %}
        {{ include(
            'TixiHomeBundle:Default:splash.html.twig'
        ) }}
    {% endblock %}

    <!--Errormessage: rendered last, displayed as a pop-up -->
    {% block errormsg %}
        <div id="overlay">
            <div>
                <p>Bitte warten...</p>
                <img  src="{{ asset('images/pleasewait.gif') }}" alt="Bitte warten ..." />
            </div>
        </div>
        {% if app.session.get('errormsg') != '' %}
            <script>alert("{{ app.session.get('errormsg') }}")</script>
        {% endif %}
    {% endblock %}

    <!--Javascripts: with lists and forms -->
    {% block javascripts %}
        <script>
            function overlay() {
                el = document.getElementById("overlay");
                el.style.visibility = (el.style.visibility == "visible") ? "hidden" : "visible";
            }
        </script>
    {% endblock %}

{% endblock %}